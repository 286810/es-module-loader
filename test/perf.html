<!doctype html>
  <script>
    // delete window.Promise;
  </script>
  <script src="../dist/es6-module-loader.js"></script>
  <script>
    System.set('module0', System.newModule({}));
    System.instantiate = function(load) {
      return {
        deps: ['module' + (load.name.substr(6) - 1)],
        execute: function() {
          eval(load.source);
          return System.newModule({});
        }
      };
    }

    function start() {
      document.body.innerHTML = '';
      var startTime = +Date.now();
      for (var i = 1; i <= 1000; i++)
        System.define('module' + i, "function q() {} var p = 5;\n // non-trivial code");
      System.import('module1000').then(function() {
        document.body.innerHTML = ((Date.now() - startTime) / 1000) + 'ms per module';
      }).catch(function(e) {
        setTimeout(function() {
          throw e;
        })
      });
    }
  </script>
  <body onclick="start()" style="height:100%">
    <p>Click to start</p>